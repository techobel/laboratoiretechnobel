{% extends "TecServiceBundle::layout.html.twig" %}
{% block title %}Populaide - Belgique - Results{% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('css/show-pages.css') }}" rel="stylesheet" type="text/css" />
{% endblock %}
{% block body %}
    {{ parent() }}
    <section id="works">
        
        {# test select json #}
        <select id="selectjson" name="selectjson">
            
        </select>
        
        <h3>Categories:</h3>
        <ul>
        {% for categorie in categories %}
            <li>{{ categorie.id ~ " " ~ categorie.name ~ " " ~ categorie.description }}<a href="{{ path('tec_service_updatecategorie',{'id': categorie.id}) }}"> Modifier</a><a href="{{ path('tec_service_delcategorie',{'id': categorie.id}) }}"> Supprimer</a></li>
            {% if categorie.media != null %}
                
                <img
                src="{{ asset(categorie.media.uploadDir ~ '/' ~ categorie.media.id ~ categorie.media.path) }}"
                alt="{{ categorie.media.alt }}"
                width="100px"
                heigth="100px"
              />
            {% endif %}
            
            <ul>
                {% for subcategorie in categorie.getSubCategories %}
                    <li>{{ subcategorie.id ~ " " ~ subcategorie.name ~ " " ~ subcategorie.description }}</li>
                    <ul>
                        {% for annonce in subcategorie.getAnnonces %}
                            <li>{{ annonce.id ~ " " ~ annonce.title }}</li>
                        {% endfor %}
                    </ul>
                {% endfor %}
            </ul>
        {% endfor %}
        
        <div id="resultat"></div>
        
        
        <button id="btn-subcategorie" name="btn-subcategorie">Afficher toutes les subcategories</button>
        <button id="btn-load" name="btn-load">Afficher toutes les subcategories 2</button>
        </ul>
    </section>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript"></script> 
    <script>
        
        //test select json
        //Genere un select avec les villes de belgique
        $.ajax({
            //dataType: "json",
            url: "{{ asset('/uploads/villes.json') }}",
            success: function(data){
                //console.log("ok");
                //console.log(data);
                $.each(data, function(a, b){
                    //console.log(b.cp);
                    $("#selectjson").append($("<option></option>").attr("value", b.cp).text(b.localite));
                    
                
                });
            },
            error: function(){
                console.log("erreur");
                }
      });
      /**
       * fin genere select avec les villes de belgique
       */
      
    /*  $.getJSON("{{ asset('/uploads/villes.json') }}", function(data){
          console.log(data);
      });*/
        
        
       $("#btn-subcategorie").click(function(e){
           $.ajax({
              type: 'post',
              url:'{{ path('tec_service_testajax')}}',
              
              success: function(data){
                  //alert('ok');
                  $('#resultat').html(data);
                  
                },
              error: function(data){
                  alert('ko');
                  alert(data);
                  $('#resultat').html(data);
                }
           });
       }) ;  
       
       //idem que l'autre mais en get
       $("#btn-load").click(function(e){
            
            $("#resultat").load("{{ path('tec_service_testajax') }}");
        });
            
            
    </script>


{% endblock %}
